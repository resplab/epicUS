<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calibrate COPD Exacerbations • epicUS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate COPD Exacerbations">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epicUS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.33.99999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BackgroundEPIC.html">EPIC Background</a>
    </li>
    <li>
      <a href="../articles/Calibrate_COPD_Exacerbations.html">Calibrate COPD Exacerbations</a>
    </li>
    <li>
      <a href="../articles/Calibrate_COPD_Prevalence.html">Calibrate COPD Prevalence</a>
    </li>
    <li>
      <a href="../articles/Calibrate_Smoking.html">Calibrate Smoking Status</a>
    </li>
    <li>
      <a href="../articles/GettingStarted.html">Getting Started with EPIC</a>
    </li>
    <li>
      <a href="../articles/Optimization.html">Optimization</a>
    </li>
    <li>
      <a href="../articles/Payoffs.html">Payoffs</a>
    </li>
    <li>
      <a href="../articles/RecalibratingEPIC.html">RecalibratingEPIC</a>
    </li>
    <li>
      <a href="../articles/Rep_bgd_Canada.html">Reproducing Background Mortality</a>
    </li>
    <li>
      <a href="../articles/Reproducing_bgd.html">Reproducing Background Mortality</a>
    </li>
    <li>
      <a href="../articles/UsingEPICinR.html">Using EPIC in R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calibrate COPD Exacerbations</h1>
            
      

      <div class="hidden name"><code>Calibrate_COPD_Exacerbations.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>This document outlines the calibration process undertaken to align
the model’s outputs with validation targets for COPD exacerbations,
using the ACCEPT study, Hoogendorn et al 2021, and CanCOLD.</p>
</div>
<div class="section level2">
<h2 id="calibration-of-copd-exacerbation-rates">Calibration of COPD Exacerbation Rates<a class="anchor" aria-label="anchor" href="#calibration-of-copd-exacerbation-rates"></a>
</h2>
<p>This section outlines the internal validation process conducted to
align the model’s simulated COPD exacerbation rates with empirical
targets drawn from key reference studies. The validation focused on both
diagnosed and undiagnosed populations and was stratified by GOLD stage
and exacerbation severity (total, moderate/severe, and severe only).
Detailed validation targets and associated calibration code are
presented below.</p>
<p><strong>Validation References:</strong></p>
<ul>
<li>Hoogendoorn et al. 2021 (DOI: 10.1183/09031936.00043710)</li>
<li>ACCEPT study (DOI: 10.1016/S2213-2600(19)30397-2)<br>
</li>
<li>CanCOLD study (DOI: 10.3109/15412555.2012.665520)</li>
</ul>
<hr>
<div class="section level3">
<h3 id="validation-targets">
<strong>Validation Targets</strong><a class="anchor" aria-label="anchor" href="#validation-targets"></a>
</h3>
<div class="section level4">
<h4 id="diagnosed-patients-total-exacerbation-rate-hoogendoorn-et-al--2021">
<strong>Diagnosed Patients – Total Exacerbation Rate (Hoogendoorn et
al. 2021)</strong><a class="anchor" aria-label="anchor" href="#diagnosed-patients-total-exacerbation-rate-hoogendoorn-et-al--2021"></a>
</h4>
<p>Simulated rates were compared against those reported by Hoogendoorn
et al. 2021: - <strong>GOLD 1:</strong> 0.82<br>
- <strong>GOLD 2:</strong> 1.17<br>
- <strong>GOLD 3:</strong> 1.61<br>
- <strong>GOLD 4:</strong> 2.10</p>
</div>
<div class="section level4">
<h4 id="diagnosed-patients-moderate-and-severe-exacerbation-rates-accept-study">
<strong>Diagnosed Patients – Moderate and Severe Exacerbation Rates
(ACCEPT Study)</strong><a class="anchor" aria-label="anchor" href="#diagnosed-patients-moderate-and-severe-exacerbation-rates-accept-study"></a>
</h4>
<p>The ACCEPT study provided target rates for moderate and severe
exacerbations: - <strong>GOLD 1:</strong> 0.58<br>
- <strong>GOLD 2:</strong> 0.91<br>
- <strong>GOLD 3:</strong> 1.41<br>
- <strong>GOLD 4:</strong> 1.69</p>
</div>
<div class="section level4">
<h4 id="diagnosed-patients-severe-exacerbation-rates">
<strong>Diagnosed Patients – Severe Exacerbation Rates</strong><a class="anchor" aria-label="anchor" href="#diagnosed-patients-severe-exacerbation-rates"></a>
</h4>
<p>Two comparator sources were used:<br>
- <strong>Hoogendoorn et al. 2021</strong><br>
- GOLD 1–4: 0.11, 0.16, 0.22, 0.28<br>
- <strong>ACCEPT Study</strong><br>
- GOLD 1–4: 0.10, 0.14, 0.32, 0.42</p>
</div>
<div class="section level4">
<h4 id="undiagnosed-patients-total-exacerbation-rate-cancold">
<strong>Undiagnosed Patients – Total Exacerbation Rate
(CanCOLD)</strong><a class="anchor" aria-label="anchor" href="#undiagnosed-patients-total-exacerbation-rate-cancold"></a>
</h4>
<p>For the undiagnosed subgroup, exacerbation rates were benchmarked
against CanCOLD data: - <strong>Total population:</strong> 0.30<br>
- <strong>GOLD 1:</strong> 0.24<br>
- <strong>GOLD 2+:</strong> 0.40</p>
</div>
<div class="section level4">
<h4 id="overall-and-gold-stratified-total-exacerbation-rates-cancold">
<strong>Overall and GOLD-Stratified Total Exacerbation Rates
(CanCOLD)</strong><a class="anchor" aria-label="anchor" href="#overall-and-gold-stratified-total-exacerbation-rates-cancold"></a>
</h4>
<p>For all individuals (diagnosed and undiagnosed), total exacerbation
rates per year were compared against the CanCOLD study benchmarks: -
<strong>Total population:</strong> 0.39<br>
- <strong>GOLD 1:</strong> 0.28<br>
- <strong>GOLD 2+:</strong> 0.53</p>
<hr>
<p>The calibration code below performs the relevant calculations and
visualizations for each validation target.</p>
</div>
</div>
<div class="section level3">
<h3 id="step-1-load-libraries-and-setup">Step 1: Load libraries and setup<a class="anchor" aria-label="anchor" href="#step-1-load-libraries-and-setup"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.0</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.1.0     </span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">epicUS</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jrnold.github.io/ggthemes/" class="external-link">ggthemes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'scales'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     discard</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:readr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     col_factor</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'reshape2'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:tidyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     smiths</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load EPIC general settings</span></span>
<span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_default_settings.html">get_default_settings</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">settings</span><span class="op">$</span><span class="va">record_mode</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">settings</span><span class="op">$</span><span class="va">n_base_agents</span> <span class="op">&lt;-</span> <span class="fl">3.5e6</span></span>
<span><span class="fu"><a href="../reference/init_session.html">init_session</a></span><span class="op">(</span>settings <span class="op">=</span> <span class="va">settings</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Initializing the session</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_input.html">get_input</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">time_horizon</span> <span class="op">&lt;-</span> <span class="fl">26</span></span>
<span></span>
<span><span class="co"># Modify intercept value to calibrate proportion of COPD exacerbations</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">exacerbation</span><span class="op">$</span><span class="va">ln_rate_betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">2.0</span>, female <span class="op">=</span> <span class="fl">0</span>, age <span class="op">=</span> <span class="fl">0.04082</span> <span class="op">*</span> <span class="fl">0.1</span>, fev1 <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, smoking_status <span class="op">=</span> <span class="fl">0.7</span>, gold1 <span class="op">=</span> <span class="fl">0.15</span> , gold2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.10</span> , gold3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.40</span> , gold4 <span class="op">=</span> <span class="op">-</span><span class="fl">0.75</span> , diagnosis_effect <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">exacerbation</span><span class="op">$</span><span class="va">logit_severity_betas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>intercept1 <span class="op">=</span> <span class="op">-</span><span class="fl">2.809</span>, intercept2 <span class="op">=</span> <span class="fl">2.402</span>, intercept3 <span class="op">=</span> <span class="fl">3.808</span>, female <span class="op">=</span> <span class="op">-</span><span class="fl">0.764</span>, age <span class="op">=</span> <span class="op">-</span><span class="fl">0.007</span>, fev1 <span class="op">=</span> <span class="fl">0.98</span>, smoking_status <span class="op">=</span> <span class="fl">0.348</span>, pack_years <span class="op">=</span> <span class="op">-</span><span class="fl">0.001</span> , BMI <span class="op">=</span> <span class="fl">0.018</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load EPIC general settings</span></span>
<span><span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ERROR:ERR_EVENT_STACK_FULL</span></span></code></pre>
<pre><code><span><span class="co">## [1] -4</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Cget_output.html">Cget_output</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">output_ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Cget_output_ex.html">Cget_output_ex</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/Cget_all_events_matrix.html">Cget_all_events_matrix</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">exac_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">exit_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Follow_up_GOLD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">last_GOLD_transition_time</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">all_events</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">last_GOLD_transition_time</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">==</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"followup_after_COPD"</span><span class="op">]</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time</span></span>
<span>      <span class="va">last_GOLD_transition_time</span> <span class="op">&lt;-</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"followup_after_COPD"</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"event"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span>      <span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">all_events</span><span class="op">[</span><span class="va">i</span>, <span class="st">"followup_after_COPD"</span><span class="op">]</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span>  <span class="co">#----------------------------DIAGNOSED ------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="va">all_events_diagnosed</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events</span>, <span class="va">diagnosis</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">gold</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span></span>
<span>  <span class="va">exac_events_diagnosed</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_diagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">)</span></span>
<span>  <span class="va">sev_exac_events_diagnosed</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_diagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">exac_status</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">mod_sev_exac_events_diagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_diagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">exac_status</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">exit_events_diagnosed</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_diagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Follow_up_GOLD_diagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">last_GOLD_transition_time_diagnosed</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">last_GOLD_transition_time_diagnosed</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">==</span> <span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Follow_up_GOLD_diagnosed</span><span class="op">[</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD_diagnosed</span><span class="op">[</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time_diagnosed</span></span>
<span>      <span class="va">last_GOLD_transition_time_diagnosed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"event"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span>      <span class="va">Follow_up_GOLD_diagnosed</span><span class="op">[</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD_diagnosed</span><span class="op">[</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_diagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time_diagnosed</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co">#----------------------------UNDIAGNOSED ------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="va">all_events_undiagnosed</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events</span>, <span class="va">diagnosis</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">gold</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">gold</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span> <span class="co">#CanCOLD is only GOLD 1 and 2</span></span>
<span>  <span class="va">exac_events_undiagnosed</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_undiagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">)</span></span>
<span>  <span class="va">sev_exac_events_undiagnosed</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_undiagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">exac_status</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">mod_sev_exac_events_undiagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_undiagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">exac_status</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">|</span> <span class="va">exac_status</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">exit_events_undiagnosed</span>         <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">all_events_undiagnosed</span>, <span class="va">event</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Follow_up_GOLD_undiagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">last_GOLD_transition_time_undiagnosed</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">last_GOLD_transition_time_undiagnosed</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span> <span class="op">==</span> <span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span> <span class="op">!=</span> <span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time_undiagnosed</span></span>
<span>      <span class="va">last_GOLD_transition_time_undiagnosed</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"event"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">14</span><span class="op">)</span></span>
<span>      <span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"local_time"</span><span class="op">]</span><span class="op">-</span><span class="va">all_events_undiagnosed</span><span class="op">[</span><span class="va">i</span>, <span class="st">"time_at_diagnosis"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span></span>
<span>        <span class="va">last_GOLD_transition_time_undiagnosed</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/terminate_session.html">terminate_session</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Terminating the session</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------All ------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Exacerbation Rates per GOLD stages for all patients:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Exacerbation Rates per GOLD stages for all patients:</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">GOLD_I</span>   <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">GOLD_II</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">GOLD_III</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">GOLD_IV</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"exacRateGOLDI   = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">GOLD_I</span>  , <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## exacRateGOLDI   = 0.47</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"exacRateGOLDII  = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">GOLD_II</span> , <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## exacRateGOLDII  = 0.86</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"exacRateGOLDIII = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">GOLD_III</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## exacRateGOLDIII = 1.35</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"exacRateGOLDIV  = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">GOLD_IV</span> , <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## exacRateGOLDIV  = 1.7</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------All ------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span>  <span class="va">total_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Follow_up_GOLD</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Exac_per_GOLD</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"CanCOLD"</span><span class="op">)</span></span>
<span>  <span class="co"># CanCOLD only available for GOLD 1 and 2. See doi: 10.1164/rccm.201509-1795OC</span></span>
<span></span>
<span>  <span class="va">Follow_up_GOLD_all_2level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">Follow_up_GOLD</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="co"># Because CanCOLD is mostly GOLD2, here we compare EPIC's GOLD2 only instead of GOLD2+</span></span>
<span>  <span class="co">#  Follow_up_GOLD_all_2level &lt;- c(Follow_up_GOLD[1], sum(Follow_up_GOLD[2:4]))</span></span>
<span>  <span class="va">GOLD_counts_all</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">GOLD_counts_all</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GOLD_counts_all</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">GOLD_counts_all</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"gold1"</span>, <span class="st">"gold2+"</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">total_rate</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">GOLD_counts_all</span><span class="op">/</span><span class="va">Follow_up_GOLD_all_2level</span>,</span>
<span>                                   digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.39</span>, <span class="fl">0.28</span>, <span class="fl">0.53</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Exac_per_GOLD</span><span class="op">)</span></span>
<span>  <span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"CanCOLD"</span><span class="op">)</span><span class="op">]</span>,id.vars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GOLD</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">14</span>, ticks<span class="op">=</span><span class="cn">F</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span> <span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Total rate of exacerbations per year for all patients"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_COPD_Exacerbations_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#--------------------------- total number of severe exacerbations:</span></span>
<span></span>
<span>  <span class="va">n_exac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year<span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,Severe_Exacerbations <span class="op">=</span> <span class="op">(</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_exac_by_ctime_severity</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_exac_by_ctime_severity</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span> <span class="op">(</span><span class="fl">100000</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_alive_by_ctime_sex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">avgRate_sevExac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">n_exac</span><span class="op">$</span><span class="va">Severe_Exacerbations</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">n_exac</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">n_exac</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">avgRate_sevExac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">avgRate_sevExac</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Average rate during 20 years: "</span>, <span class="va">avgRate_sevExac</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Average rate during 20 years: 775.85</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rate2017_sevExac</span> <span class="op">&lt;-</span><span class="op">(</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_exac_by_ctime_severity</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span><span class="op">+</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_exac_by_ctime_severity</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">100000</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">output_ex</span><span class="op">$</span><span class="va">n_alive_by_ctime_sex</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">rate2017_sevExac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rate2017_sevExac</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Rate in 2017: "</span>, <span class="va">rate2017_sevExac</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rate in 2017: 511.54</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------Diagnosed ------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"Hoogendoorn"</span><span class="op">)</span></span>
<span>  <span class="co"># ACCEPT data is rates from a join of ECLIPSE, MACRO, OPTIMAL and STATCOPE.</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold1"</span>, <span class="st">"gold2"</span>, <span class="st">"gold3"</span>, <span class="st">"gold4"</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events_diagnosed</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span></span>
<span>      <span class="va">Follow_up_GOLD_diagnosed</span>, digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.82</span>, <span class="fl">1.17</span>, <span class="fl">1.61</span>, <span class="fl">2.10</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span></span>
<span>  <span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"Hoogendoorn"</span><span class="op">)</span><span class="op">]</span>,id.vars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GOLD</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">14</span>, ticks<span class="op">=</span><span class="cn">F</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span> <span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Total rate of exacerbations per year for diagnosed patients"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_COPD_Exacerbations_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Total rate of exacerbation in diagnosed patients (1.5 per year in Hoogendoorn): "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exac_events_diagnosed</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Follow_up_GOLD_diagnosed</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Total rate of exacerbation in diagnosed patients (1.5 per year in Hoogendoorn): 1.1</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------Diagnosed Moderate and Severe------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"ACCEPT"</span><span class="op">)</span></span>
<span>  <span class="co"># ACCEPT data is rates from a join of ECLIPSE, MACRO, OPTIMAL and STATCOPE.</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold1"</span>, <span class="st">"gold2"</span>, <span class="st">"gold3"</span>, <span class="st">"gold4"</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">mod_sev_exac_events_diagnosed</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span></span>
<span>      <span class="va">Follow_up_GOLD_diagnosed</span>, digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.58</span>, <span class="fl">0.91</span>, <span class="fl">1.41</span>, <span class="fl">1.69</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span></span>
<span>  <span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"ACCEPT"</span><span class="op">)</span><span class="op">]</span>,id.vars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GOLD</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">14</span>, ticks<span class="op">=</span><span class="cn">F</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span> <span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Total rate of moderate/severe exacerbations per year for diagnosed patients"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_COPD_Exacerbations_files/figure-html/unnamed-chunk-1-3.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------Diagnosed Severe------------------------------------</span></span>
<span>  <span class="co">#-------------------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"Hoogendoorn"</span>, <span class="st">"ACCEPT"</span><span class="op">)</span></span>
<span>  <span class="co"># ACCEPT data is rates from a join of ECLIPSE, MACRO, OPTIMAL and STATCOPE.</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gold1"</span>, <span class="st">"gold2"</span>, <span class="st">"gold3"</span>, <span class="st">"gold4"</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sev_exac_events_diagnosed</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">/</span></span>
<span>      <span class="va">Follow_up_GOLD_diagnosed</span>, digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.11</span>, <span class="fl">0.16</span>, <span class="fl">0.22</span>, <span class="fl">0.28</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_diagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.14</span>, <span class="fl">0.32</span>, <span class="fl">0.42</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_diagnosed</span><span class="op">)</span></span>
<span>  <span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"Hoogendoorn"</span>, <span class="st">"ACCEPT"</span><span class="op">)</span><span class="op">]</span>,id.vars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GOLD</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">14</span>, ticks<span class="op">=</span><span class="cn">F</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span> <span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Total rate of severe exacerbations per year for diagnosed patients"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_COPD_Exacerbations_files/figure-html/unnamed-chunk-1-4.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#----------------------------Undiagnosed ------------------------------------</span></span>
<span>  <span class="co">#----------------------------------------------------------------------------</span></span>
<span>  <span class="va">total_rate_undiagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exac_events_undiagnosed</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_undiagnosed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_undiagnosed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"CanCOLD"</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_undiagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"gold1"</span>, <span class="st">"gold2+"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">Follow_up_GOLD_undiagnosed_2level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                         <span class="va">Follow_up_GOLD_undiagnosed</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="co">#Because CANCold is mostly GOLD2, we comprare to GOLD2 EPIC</span></span>
<span>  <span class="co">#Follow_up_GOLD_undiagnosed_2level &lt;- c(Follow_up_GOLD_undiagnosed[1], sum(Follow_up_GOLD_undiagnosed[2:4]))</span></span>
<span>  <span class="va">GOLD_counts_undiagnosed</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">exac_events_undiagnosed</span><span class="op">[</span>, <span class="st">"gold"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">GOLD_counts_undiagnosed</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">GOLD_counts_undiagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                 <span class="va">GOLD_counts_undiagnosed</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="va">Exac_per_GOLD_undiagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">total_rate_undiagnosed</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">GOLD_counts_undiagnosed</span><span class="op">/</span><span class="va">Follow_up_GOLD_undiagnosed_2level</span>, digit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">Exac_per_GOLD_undiagnosed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">0.24</span>, <span class="fl">0.40</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Exac_per_GOLD_undiagnosed</span><span class="op">)</span></span>
<span>  <span class="va">dfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GOLD"</span>, <span class="st">"EPIC"</span>, <span class="st">"CanCOLD"</span><span class="op">)</span><span class="op">]</span>,id.vars <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dfm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">GOLD</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="http://jrnold.github.io/ggthemes/reference/theme_tufte.html" class="external-link">theme_tufte</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">14</span>, ticks<span class="op">=</span><span class="cn">F</span><span class="op">)</span>  <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span> <span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Total rate of exacerbations per year for undiagnosed patients"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calibrate_COPD_Exacerbations_files/figure-html/unnamed-chunk-1-5.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Total rate of exacerbation in undiagnosed patients (0.30 per year in CanCOLD): "</span>,</span>
<span>          <span class="va">total_rate_undiagnosed</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Total rate of exacerbation in undiagnosed patients (0.30 per year in CanCOLD): 0.52</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mohsen Sadatsafavi, Amin Adibi, Kate Johnson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
